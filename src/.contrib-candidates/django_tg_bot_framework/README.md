# Django Tg Bot Framework

Фреймворк [Django Tg Bot Framework](https://gitlab.levelupdev.ru/dvmn-open-source-dev-tools/django_tg_bot_framework)
находится пока на ранних этапах разработки и быстро меняется. Чтобы итерировать быстро и не терять при этом обратной
совместимости во фреймворк включена только самая базовая "core" функциональность, а всё остальное вынесено наружу. В
этом каталоге собран такой код, который уже весьма полезнен, но всё ещё недостачно стабилен для включения в кодовую
базу [Django Tg Bot Framework](https://gitlab.levelupdev.ru/dvmn-open-source-dev-tools/django_tg_bot_framework) или
других библиотек.

## Как запустить проверку БД в editable_messages

Приложение `editable_messages` может проверять готовность БД к работе бота. Будет проверено наличие всех необходимых
сообщений и кнопок. Проверка запускается менеджмент командой `check_db`.
В качестве аргументов в команду необходимо передать путь к объекту `MessageRouter`, в котором зарегистрированы контракты
сообщений, а так же строкой через запятую языковые коды, для проверки.\
Например данная команда проверит соответствие БД для русского и английского языков для роутера по адресу
`tg_bot.states.message_router`:

```shell
./manage.py check_db tg_bot.states.message_router "ru, en"
```

Алгоритм проверки может сам найти объект `MessageRouter`, зарегистрированный в админке. Для этого вместо пути к объекту
нужно указать `--default-admin-site`:

```shell
./manage.py check_db --default-admin-site ru
```
Эта команда проверит соответствие БД для русского языка для роутера, который зарегистрирован в админке.

В случае обнаружения проблем в БД можно возбудить ошибку с помощью опции `--raise`. Ошибка будет возбуждена только в
случае отсутствия необходимых сообщений или кнопок:

```shell
./manage.py check_db --default-admin-site --raise "ru, en"
```



